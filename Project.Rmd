```{r}
library(ggplot2)
library(tidyverse)
library(dplyr)
```

```{r}
df <- read.csv("data/owid-energy.csv")
```

## Question 1

```{r}
df_2021 = df[df$year == 2021, ]

df_2021_top_5 <- df_2021[df_2021$country == "China" | df_2018$country == "India" | df_2018$country == "United States" | df_2018$country == "Japan" | df_2018$country == "Germany", ]
```

```{r}
df_2021_top_5_important_metric <- df_2018_top_5[,c("country", "population", "gdp", "biofuel_share_elec",  "coal_share_elec", "fossil_share_elec", "gas_share_elec", "hydro_share_elec", "low_carbon_share_elec", "nuclear_share_elec", "oil_share_elec", "other_renewables_share_elec", "renewables_share_elec", "solar_share_elec", "wind_share_elec")]
```

```{r}
df_2021_top_5_important_metric
```

```{r}
df_2021_top_5_important_metric$total = df_2021_top_5_important_metric$biofuel_share_elec + df_2021_top_5_important_metric$coal_share_elec + 
df_2021_top_5_important_metric$gas_share_elec +
df_2021_top_5_important_metric$hydro_share_elec +
df_2021_top_5_important_metric$nuclear_share_elec +
df_2021_top_5_important_metric$oil_share_elec +
df_2021_top_5_important_metric$solar_share_elec +
df_2021_top_5_important_metric$wind_share_elec
```

```{r}
df_2021_top_5_important_metric <- pivot_longer(df_2021_top_5_important_metric, cols = c("biofuel_share_elec", "coal_share_elec", "gas_share_elec", "hydro_share_elec", "nuclear_share_elec", "oil_share_elec", "solar_share_elec", "wind_share_elec"), names_to = "eletric_share_type", values_to = "percentage")
```

```{r}
ggplot(df_2021_top_5_important_metric, aes(fill=eletric_share_type, y=percentage, x=country)) + 
  geom_bar(position="fill", stat="identity") +
  scale_fill_viridis_d(option = "turbo") +
  labs(title = "Eletricity generation constitution of 5 most highest GDP in 2018", x = "Country", y = "Percentage", fill = "Type of eletricity generation")
```
